{% if resource.properties.capabilities %}
<section class="resource-detail-section">
    <h2 id="capabilities">
        Capabilities
        <span class="text-body-secondary">({{ resource.properties.capabilities|length }})</span>
    </h2>
    {% if resource.properties.capabilities|length == 1 %}
    {% with cap=resource.properties.capabilities.0 %}
    {% include 'browse/detail/components/capability_details_pane_component.html' %}
    {% endwith %}
    {% else %}
    <details class="details-capabilities-top" open>
        <summary class="d-inline-block">
            <span class="fs-6 fw-semibold text-body">
                <!-- Show when details are collapsed -->
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-bar-expand collapsed" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M3.646 10.146a.5.5 0 0 1 .708 0L8 13.793l3.646-3.647a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 0-.708m0-4.292a.5.5 0 0 0 .708 0L8 2.207l3.646 3.647a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 0 0 0 .708M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8"/>
                </svg>
                <!-- Show when details are open -->
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-bar-contract open" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M3.646 14.854a.5.5 0 0 0 .708 0L8 11.207l3.646 3.647a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 0 0 0 .708m0-13.708a.5.5 0 0 1 .708 0L8 4.793l3.646-3.647a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 0-.708M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8"/>
                </svg>
                <span class="link-underline-by-default">
                    <span class="collapsed">Show</span>
                    <span class="open">Hide</span>
                    {{ resource.properties.capabilities|length }} capabilities
                </span>
            </span>
        </summary>
        <ul class="list-group list-group-flush mt-2">
            {% for cap in resource.properties.capabilities %}
            <li class="list-group-item p-0">
                {% if forloop.counter == 1 %}
                {% with is_open=True %}
                {% include 'browse/detail/components/capability_details_component.html' %}
                {% endwith %}
                {% else %}
                {% with is_open=False %}
                {% include 'browse/detail/components/capability_details_component.html' %}
                {% endwith %}
                {% endif %}
            </li>
            {% endfor %}
        </ul>
    </details>
    {% endif %}
</section>
{% endif %}